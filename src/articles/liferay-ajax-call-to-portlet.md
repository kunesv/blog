---
title: Ajax Call To Portlet With AUI
date: 2012-05-11
summary: Imagine you want to bring some more content to your portlet in response to user action, without the urge to reload whole browser window. You will use good ol' Ajax Call, of course.
layout: article.html
---

Imagine you want to bring some more content to your web page in response to user action without the urge to reload whole browser window. You will use Ajax Call, of course.

![](/images/aui_call.jpg)

## Create URL & Call

Supplied solution works only for Ajax calls within one portlet instance. It should also work for calls between different portlets within same portal page. If you want to call different portlet, see section Using two different portlets few paragraphs below.

    <liferay-portlet:renderURL windowState="<%= LiferayWindowState.POP_UP.toString() %>" portletName="ajaxcontentportlet_WAR_AjaxContentProviderportlet(see below)" var="portletUrl">
        <liferay-portlet:param name="testParameter" value="TestParamValue"/>
    </liferay-portlet:renderURL

You will get portletId in above code by putting your source portlet on some portal page and examine generated html: You should find id attribute of main portlet div -- pick just the portion after p_p_id, without those surrounding underscores. See image below - Code display by FireBug.

![](/images/aui_firebug.jpg)

Ajax call is fired by click on the link.

    <aui:a href="<%= portletUrl %>" id="linkGetContent" label="Get Content"/>

    <aui:script use="node,node-load">
    A.one('#<portlet:namespace/>linkGetContent').on('click', function (event) {
        event.halt();
        A.one('#result').load('<%= portletUrl %>', '#source');
    });
    </aui:script>

Finally add some place to put that fetched content.

    <div id="result">Result will show here.</div>

## Source text

To avoid all exceeding content, generated by the portlet, wrap your code into another div. Use identificator of this div in the Ajax load function above.

    <div id="source">
    Served content here.
    </div>

## Using two different portlets

To use setup with two different portlets, you can use solution where you call servlet in Source portlet.

Create new file web.xml in /docroot/WEB-INF directory of Source portlet.

    <?xml version="1.0"?>
    <!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">

    <web-app>
        <servlet>
            <servlet-name>SourcePageServlet</servlet-name>
            <servlet-class>cz.sprinters.portlet.SourcePageServlet</servlet-class>
        </servlet>
        <servlet-mapping>
            <servlet-name>SourcePageServlet</servlet-name>
            <url-pattern>/servlet/do</url-pattern>
        </servlet-mapping>
    </web-app>

New portletUrl used would look like this `/ajaxcontentportlet-portlet/servlet/do?testParameter=TestParamValue`.